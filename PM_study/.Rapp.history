NJ <- plot_usmap(include = c("NJ"))
NJ
NJ <- plot_usmap(include = c("NJ"),regions="counties")
NJ
NJ <- plot_usmap(include = c("NJ"),regions="counties",labels=TRUE)
quit()
install.packages(c("maps","mapdata"))
devtools::install_github("dkahle/ggmap")
install.packages("devtools")
devtools::install_github("dkahle/ggmap")
library(ggplot2)
library(ggmap)
library(maps)
library(mapdata)
USA <- map_data("usa")
STATES <- mad_data('state')
STATES <- map_data('state')
NJ <- subset(states,region == "new jersey")
NJ <- subset(STATES,region == "new jersey")
ggplot(data = NJ) + geom_polygon(aes(x=long,y=lat))
ggplot(data = NJ,aes(x=long,y=lat)) + geom_polygon(fill="palegreen",color="black")
ggplot(data = NJ,aes(x=long,y=lat,group=group)) + geom_polygon(fill="palegreen",color="black") + coord_fixed(1.3)
COUNTY <- map_data("county")
NJ.COUNTY <- subset(COUNTY,region == "new jersey")
NJ.PLOT <- ggplot(data = NJ.COUNTY,aes(x=long,y=lat,group=group))
NJ.PLOT + geom_polygon(fill="palegreen",color="black")
NJ.PLOT + geom_polygon(fill="palegreen",color="black") + coord_fixed(1.2)
quit(0)
quit()
library(ggplot2)#
library(ggmap)#
library(maps)#
library(mapdata)#
#
STATES <- map_data('state')#
STATES.NJ <- subset(#
                    STATES,#
                    region == "new jersey"#
                    )#
COUNTIES <- map_data("county")#
COUNTIES.NJ <- subset(#
                      COUNTIES,#
                      region == "new jersey"#
                      )#
NJ.PLOT <- ggplot(#
                  data = STATES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           theme_nothing() +#
           coord_fixed(1.2)
NJ.PLOT
NJ.PLOT +#
geom_polygon(#
             data = COUNTIES.NJ,#
             fill = NA,#
             color = "white"#
             )
NJ.PLOT +#
geom_polygon(#
             data = COUNTIES.NJ,#
             fill = NA,#
             color = "white"#
             ) +#
coord_fixed(1.2)
NJ.PLOT +#
geom_polygon(#
             data = COUNTIES.NJ,#
             fill = NA,#
             color = "white"#
             ) +#
geom_polygon(#
             color = "black",#
             fill = NA#
             ) +#
coord_fixed(1.2)
LOCATION <- c(#
              "caldwell_house",#
              "passion_puddle"#
              )#
LONGITUDE <- c(#
               40.85557,#
               40.48186#
               )#
LATITUDE <- c(#
              -74.90974,#
              -74.43618#
              )#
LOCATIONS <- data.frame(LOCATION,LONGITUDE,LATITUDE)
LOCATIONS
NJ.PLOT +#
geom_polygon(#
             data = COUNTIES.NJ,#
             fill = NA,#
             color = "white"#
             ) +#
geom_polygon(#
             color = "black",#
             fill = NA#
             ) +#
coord_fixed(1.2) +#
geom_point(#
           aes(#
               data = LOCATIONS#
               x = LONGITUDE,#
               y = LATITUDE#
               )#
           )
NJ.PLOT +#
geom_polygon(#
             data = COUNTIES.NJ,#
             fill = NA,#
             color = "white"#
             ) +#
geom_polygon(#
             color = "black",#
             fill = NA#
             ) +#
coord_fixed(1.2) +#
geom_point(#
           aes(#
               data = LOCATIONS,#
               x = LONGITUDE,#
               y = LATITUDE#
               )#
           )
NJ.PLOT +#
geom_polygon(#
             data = COUNTIES.NJ,#
             fill = NA,#
             color = "white"#
             ) +#
geom_polygon(#
             color = "black",#
             fill = NA#
             ) +#
coord_fixed(1.2) +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE#
               )#
           )
NJCOUNTY.PLOT <- NJ.PLOT +#
                 geom_polygon(#
                              data = COUNTIES.NJ,#
                              fill = NA,#
                              color = "white"#
                              ) +#
                 geom_polygon(#
                              color = "black",#
                              fill = NA#
                              ) +#
                 coord_fixed(1.2)
NJCOUNTY.PLOT
LOCATIONS
NJCOUNTY.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               group = LOCATION#
               )#
           )
NJCOUNTY.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE#
               )#
           )
NJCOUNTY.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               color = LOCATION#
               )#
           )
NJCOUNTY.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE#
               )#
           color = LOCATION#
           )
NJCOUNTY.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE#
               ),#
           color = LOCATION#
           )
NJCOUNTY.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               group = group#
               ),#
           color = LOCATION#
           )
NJCOUNTY.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               group = LOCATION#
               ),#
           color = LOCATION#
           )
NJCOUNTY.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               group = LOCATION,#
               color = LOCATION#
               )#
           )
NJCOUNTY.PLOT
LOCATIONS <- data.frame(LOCATION,LONGITUDE,LATITUDE,stringsAsFactors=FALSE)
NJCOUNTY.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               group = LOCATION,#
               color = LOCATION#
               )#
           )
NJCOUNTY.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE#
               color = LOCATION#
               )#
           )
NJCOUNTY.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               color = LOCATION#
               )#
           )
NJCOUNTY.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE#
               )#
           )
NJ.PLOT <- ggplot(#
                  data = COUNTIES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           theme_nothing() +#
           coord_fixed(1.2)
NJ.PLOT
NJ.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE#
               )#
           )
NJ.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               group = 5#
               )#
           )
NJ.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               color = LOCATION#
               )#
           )
NJ.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               ),#
           color = "black"#
           )
head(COUNTIES.NJ)
unique(COUNTIES.NJ$group)
NJ.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               group = 1763#
               ),#
           color = "black"#
           )
NJ.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               group = 1763#
               ),#
           color = "black"#
           )#
coord_fixed(1.2)
NJ.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               group = 1763#
               ),#
           color = "black"#
           ) + #
coord_fixed(1.2)
range(COUNTIES.NJ$long)
LOCATION <- c(#
              "caldwell_house",#
              "passion_puddle"#
              )#
LATITUDE <- c(#
              40.85557,#
              40.48186#
              )#
LONGITUDE <- c(#
               -74.90974,#
               -74.43618#
               )#
LOCATIONS <- data.frame(LOCATION,LONGITUDE,LATITUDE,stringsAsFactors=FALSE)
NJ.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               ),#
           color = "black"#
           ) + #
coord_fixed(1.2)
NJ.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               group = 1763#
               ),#
           color = "black"#
           ) + #
coord_fixed(1.2)
NJ.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               group = 1763,#
               color = LOCATION#
               )#
           ) + #
coord_fixed(1.2)
NJ.PLOT +#
geom_point(#
           data = LOCATIONS,#
           aes(#
               x = LONGITUDE,#
               y = LATITUDE,#
               group = 1763,#
               color = LOCATION#
               )#
           ) + #
coord_fixed(1.2) +#
theme(#
      legend.position = "right"#
      )
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = LOCATIONS,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              color = LOCATION#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right"#
                     )
SAMPLE.PLOT
quit()
library(ggplot2)#
library(ggmap)#
library(maps)#
library(mapdata)#
#
# create dataframe for sampling sites#
SITE <- c(#
          "caldwell_house",#
          "passion_puddle"#
          )#
LONGITUDE <- c(#
               -74.90974,#
               -74.43618#
               )#
LATITUDE <- c(#
              40.85557,#
              40.48186#
              )#
SAMPLE.DF <- data.frame(#
                        SITE,#
                        LONGITUDE,#
                        LATITUDE#
                        )#
#
# create NJ plot with counties#
COUNTIES <- map_data("county")#
COUNTIES.NJ <- subset(#
                      COUNTIES,#
                      region == "new jersey"#
                      )#
NJ.PLOT <- ggplot(#
                  data = COUNTIES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           theme_nothing() +#
           coord_fixed(1.2)#
#
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = LOCATIONS,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              color = LOCATION#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right"#
                     )
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SITE,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              color = LOCATION#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right"#
                     )
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              color = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right"#
                     )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              color = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right"#
                     legend.text = element_text(#
                                                color = "black"#
                                                )#
                     )
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              color = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black"#
                                                )#
                     )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              color = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black"#
                                                size = 12#
                                                )#
                     )
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              color = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              color = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_color_manual(#
                                  names = c(#
                                            "Caldwell House",#
                                            "Passion Puddle"#
                                            )#
                                  )
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              color = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_color_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle"#
                                             )#
                                   )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              color = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_color_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle"#
                                             ),#
                                  values = c(#
                                             "darkorange",#
                                             "darkorchid"#
                                             )#
                                   )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              fill = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_fill_manual(#
                                 labels = c(#
                                            "Caldwell House",#
                                            "Passion Puddle"#
                                            ),#
                                 values = c(#
                                            "darkorange",#
                                            "darkorchid"#
                                            )#
                                 ) +#
               scale_shape_manual(#
                                  values = c(#
                                             21,#
                                             21,#
                                             23#
                                             )#
                                  )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              fill = SITE#
                              shape = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_fill_manual(#
                                 labels = c(#
                                            "Caldwell House",#
                                            "Passion Puddle"#
                                            ),#
                                 values = c(#
                                            "darkorange",#
                                            "darkorchid"#
                                            )#
                                 ) +#
               scale_shape_manual(#
                                  values = c(#
                                             21,#
                                             21,#
                                             23#
                                             )#
                                  )
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              fill = SITE,#
                              shape = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_fill_manual(#
                                 labels = c(#
                                            "Caldwell House",#
                                            "Passion Puddle"#
                                            ),#
                                 values = c(#
                                            "darkorange",#
                                            "darkorchid"#
                                            )#
                                 ) +#
               scale_shape_manual(#
                                  values = c(#
                                             21,#
                                             21,#
                                             23#
                                             )#
                                  )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_fill_manual(#
                                 labels = c(#
                                            "Caldwell House",#
                                            "Passion Puddle"#
                                            ),#
                                 values = c(#
                                            "darkorange",#
                                            "darkorchid"#
                                            )#
                                 ) +#
               scale_shape_manual(#
                                  values = c(#
                                             21,#
                                             21,#
                                             23#
                                             )#
                                  )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              fill = SITE,#
                              shape = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_fill_manual(#
                                 labels = c(#
                                            "Caldwell House",#
                                            "Passion Puddle"#
                                            ),#
                                 values = c(#
                                            "darkorange",#
                                            "darkorchid"#
                                            )#
                                 )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_fill_manual(#
                                 labels = c(#
                                            "Caldwell House",#
                                            "Passion Puddle"#
                                            ),#
                                 values = c(#
                                            "darkorange",#
                                            "darkorchid"#
                                            )#
                                 )
SAMLE.PLOT
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle"#
                                             ),#
                                  values = c(#
                                             21,#
                                             21#
                                             )#
                                 )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          color = "firebrick",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle"#
                                             ),#
                                  values = c(#
                                             21,#
                                             21#
                                             )#
                                 )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle"#
                                             ),#
                                  values = c(#
                                             21,#
                                             21#
                                             )#
                                 )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle"#
                                             ),#
                                  values = c(#
                                             21,#
                                             21#
                                             )#
                                 )
SAMPLE.PLOT
quit()
library(ggplot2)#
library(maps)#
library(mapdata)#
#
# create dataframe for sampling sites#
SITE <- c(#
          "caldwell_house",#
          "passion_puddle"#
          )#
LONGITUDE <- c(#
               -74.90974,#
               -74.43618#
               )#
LATITUDE <- c(#
              40.85557,#
              40.48186#
              )#
SAMPLE.DF <- data.frame(#
                        SITE,#
                        LONGITUDE,#
                        LATITUDE#
                        )#
#
# create NJ plot with counties#
COUNTIES <- map_data("county")#
COUNTIES.NJ <- subset(#
                      COUNTIES,#
                      region == "new jersey"#
                      )#
NJ.PLOT <- ggplot(#
                  data = COUNTIES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           theme_nothing() +#
           coord_fixed(1.2)#
#
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle"#
                                             ),#
                                  values = c(#
                                             21,#
                                             21#
                                             )#
                                 )
library(ggmap)
# create dataframe for sampling sites#
SITE <- c(#
          "caldwell_house",#
          "passion_puddle"#
          )#
LONGITUDE <- c(#
               -74.90974,#
               -74.43618#
               )#
LATITUDE <- c(#
              40.85557,#
              40.48186#
              )#
SAMPLE.DF <- data.frame(#
                        SITE,#
                        LONGITUDE,#
                        LATITUDE#
                        )#
#
# create NJ plot with counties#
COUNTIES <- map_data("county")#
COUNTIES.NJ <- subset(#
                      COUNTIES,#
                      region == "new jersey"#
                      )#
NJ.PLOT <- ggplot(#
                  data = COUNTIES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           theme_nothing() +#
           coord_fixed(1.2)#
#
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle"#
                                             ),#
                                  values = c(#
                                             21,#
                                             21#
                                             )#
                                 )
SAMPLE.PLOT
library(ggplot2)#
librar(ggmap)#
library(maps)#
library(mapdata)#
#
# create dataframe for sampling sites#
SITE <- c(#
          "caldwell_house",#
          "passion_puddle"#
          "princeton_meadows"#
          )#
LONGITUDE <- c(#
               -74.90974,#
               -74.43618,#
               -74.602714#
               )#
LATITUDE <- c(#
              40.85557,#
              40.48186,#
              40.327214#
              )#
SAMPLE.DF <- data.frame(#
                        SITE,#
                        LONGITUDE,#
                        LATITUDE#
                        )#
#
# create NJ plot with counties#
COUNTIES <- map_data("county")#
COUNTIES.NJ <- subset(#
                      COUNTIES,#
                      region == "new jersey"#
                      )#
NJ.PLOT <- ggplot(#
                  data = COUNTIES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           theme_nothing() +#
           coord_fixed(1.2)#
#
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             21#
                                             )#
                                 )
# create dataframe for sampling sites#
SITE <- c(#
          "caldwell_house",#
          "passion_puddle",#
          "princeton_meadows"#
          )#
LONGITUDE <- c(#
               -74.90974,#
               -74.43618,#
               -74.602714#
               )#
LATITUDE <- c(#
              40.85557,#
              40.48186,#
              40.327214#
              )#
SAMPLE.DF <- data.frame(#
                        SITE,#
                        LONGITUDE,#
                        LATITUDE#
                        )#
#
# create NJ plot with counties#
COUNTIES <- map_data("county")#
COUNTIES.NJ <- subset(#
                      COUNTIES,#
                      region == "new jersey"#
                      )#
NJ.PLOT <- ggplot(#
                  data = COUNTIES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           theme_nothing() +#
           coord_fixed(1.2)#
#
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             21#
                                             )#
                                 )
SAMPLE.PLOT
# create dataframe for sampling sites#
SITE <- c(#
          "caldwell_house",#
          "passion_puddle",#
          "princeton_meadows"#
          )#
LONGITUDE <- c(#
               -74.90974,#
               -74.43618,#
               -74.602714#
               )#
LATITUDE <- c(#
              40.85557,#
              40.48186,#
              40.327214#
              )#
SAMPLE.DF <- data.frame(#
                        SITE,#
                        LONGITUDE,#
                        LATITUDE#
                        )#
#
# create NJ plot with counties#
COUNTIES <- map_data("county")#
COUNTIES.NJ <- subset(#
                      COUNTIES,#
                      region == "new jersey"#
                      )#
NJ.PLOT <- ggplot(#
                  data = COUNTIES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           theme_nothing() +#
           coord_fixed(1.2)#
#
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                 )
SAMPLE.PLOT
install.packages("ggsn")
# create dataframe for sampling sites#
SITE <- c(#
          "caldwell_house",#
          "passion_puddle",#
          "princeton_meadows"#
          )#
LONGITUDE <- c(#
               -74.90974,#
               -74.43618,#
               -74.602714#
               )#
LATITUDE <- c(#
              40.85557,#
              40.48186,#
              40.327214#
              )#
SAMPLE.DF <- data.frame(#
                        SITE,#
                        LONGITUDE,#
                        LATITUDE#
                        )#
#
# create NJ plot with counties#
COUNTIES <- map_data("county")#
COUNTIES.NJ <- subset(#
                      COUNTIES,#
                      region == "new jersey"#
                      )#
NJ.PLOT <- ggplot(#
                  data = COUNTIES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           theme_nothing() +#
           coord_fixed(1.2)#
#
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                 ) +#
               scalebar(#
                        SAMPLE.DF,#
                        dist = 5,#
                        dist_unit = "km"#
                        )
library(ggsn)
# create dataframe for sampling sites#
SITE <- c(#
          "caldwell_house",#
          "passion_puddle",#
          "princeton_meadows"#
          )#
LONGITUDE <- c(#
               -74.90974,#
               -74.43618,#
               -74.602714#
               )#
LATITUDE <- c(#
              40.85557,#
              40.48186,#
              40.327214#
              )#
SAMPLE.DF <- data.frame(#
                        SITE,#
                        LONGITUDE,#
                        LATITUDE#
                        )#
#
# create NJ plot with counties#
COUNTIES <- map_data("county")#
COUNTIES.NJ <- subset(#
                      COUNTIES,#
                      region == "new jersey"#
                      )#
NJ.PLOT <- ggplot(#
                  data = COUNTIES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           theme_nothing() +#
           coord_fixed(1.2)#
#
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                 ) +#
               scalebar(#
                        SAMPLE.DF,#
                        dist = 5,#
                        dist_unit = "km"#
                        )
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                 ) +#
               scalebar(#
                        SAMPLE.DF,#
                        dist = 5,#
                        dist_unit = "km",#
                        transform = TRUE#
                        )
warnings()
NJ.PLOT <- ggplot(#
                  data = COUNTIES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           #theme_nothing() +#
           coord_fixed(1.2)#
#
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                 ) +#
               scalebar(#
                        SAMPLE.DF,#
                        dist = 5,#
                        dist_unit = "km",#
                        transform = TRUE#
                        )
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                 )
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                 )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTS.NJ,#
                        dist = 5,#
                        dist_unit = "km",#
                        transform = TRUE#
                        location = "bottomright",#
                        )
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTS.NJ,#
                        dist = 5,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        location = "bottomright"#
                        )
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 5,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        location = "bottomright"#
                        )
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 5,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 1,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        )
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 0.5,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        )
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 0.5,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        model = "GRS67,#
                        )
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 0.5,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        model = "GRS67#
                        )
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 0.5,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        model = "GRS67"#
                        )
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 5,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        model = "GRS67"#
                        )
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 5,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        model = "GRS67"#
                        ) +#
               coord_cartesian(clip = "off")
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 5,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        model = "GRS67"#
                        )
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 5,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        model = "GRS67"#
                        ) +#
               xlim(-76,-73)
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 5,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        model = "GRS67"#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 5,#
                        dist_unit = "mi",#
                        transform = TRUE,#
                        model = "GRS67"#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        model = "GRS67"#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        model = "Clarke"#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        model = "International"#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        st.size = 0.01#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        st.size = 1#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.pLOT
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        st.size = 5#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
COUNTIES.NJ
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(COUNTIES.NJ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright"#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                -73.75,#
                                39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                x = -73.75,#
                                y = 39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                x = -73.75,#
                                y = 39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        anchor = c(#
                                   -74,#
                                   39.25#
                                   ),#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                x = -73.75,#
                                y = 39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        anchor = c(#
                                   x = -74,#
                                   y = 39.25#
                                   ),#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                x = -73.70,#
                                y = 39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        anchor = c(#
                                   x = -73.70,#
                                   y = 39.10#
                                   ),#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme_void() +#
               theme(#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                x = -73.70,#
                                y = 39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        anchor = c(#
                                   x = -73.70,#
                                   y = 39.10#
                                   ),#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme_void() +#
               theme(#
                     legend.title = element_text(#
                                                 color = "black",#
                                                 size = 12,#
                                                 face = "bold"#
                                                 ),#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 8#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                x = -73.70,#
                                y = 39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        anchor = c(#
                                   x = -73.70,#
                                   y = 39.10#
                                   ),#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme_void() +#
               theme(#
                     legend.title = element_text(#
                                                 color = "black",#
                                                 size = 12,#
                                                 face = "bold"#
                                                 ),#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 8#
                                                face = "bold"#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  name = "Site",#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                x = -73.70,#
                                y = 39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        anchor = c(#
                                   x = -73.70,#
                                   y = 39.10#
                                   ),#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme_void() +#
               theme(#
                     legend.title = element_text(#
                                                 color = "black",#
                                                 size = 12,#
                                                 face = "bold"#
                                                 ),#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 8,#
                                                face = "bold"#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  name = "Site",#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                x = -73.70,#
                                y = 39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        anchor = c(#
                                   x = -73.70,#
                                   y = 39.10#
                                   ),#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
quit()
library(ggplot2)#
library(ggmap)#
library(maps)#
library(mapdata)#
library(ggsn)#
#
# create dataframe for sampling sites#
SITE <- c(#
          "caldwell_house",#
          "passion_puddle",#
          "princeton_meadows"#
          )#
LONGITUDE <- c(#
               -74.909973,#
               -74.4370964,#
               -74.608153#
               )#
LATITUDE <- c(#
              40.855126,#
              40.4829431,#
              40.327140#
              )#
SAMPLE.DF <- data.frame(#
                        SITE,#
                        LONGITUDE,#
                        LATITUDE#
                        )#
#
# create NJ plot with counties#
COUNTIES <- map_data("county")#
COUNTIES.NJ <- subset(#
                      COUNTIES,#
                      region == "new jersey"#
                      )#
NJ.PLOT <- ggplot(#
                  data = COUNTIES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           #theme_nothing() +#
           coord_fixed(1.2)#
#
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme_void() +#
               theme(#
                     legend.title = element_text(#
                                                 color = "black",#
                                                 size = 16,#
                                                 face = "bold"#
                                                 ),#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12,#
                                                face = "bold"#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  name = "Site",#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                x = -73.70,#
                                y = 39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        anchor = c(#
                                   x = -73.70,#
                                   y = 39.10#
                                   ),#
                        transform = TRUE,#
                        st.size = 2#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
library(ggplot2)#
library(ggmap)#
library(maps)#
library(mapdata)#
library(ggsn)#
#
# create dataframe for sampling sites#
SITE <- c(#
          "caldwell_house",#
          "passion_puddle",#
          "princeton_meadows"#
          )#
LONGITUDE <- c(#
               -74.909973,#
               -74.4370964,#
               -74.608153#
               )#
LATITUDE <- c(#
              40.855126,#
              40.4829431,#
              40.327140#
              )#
SAMPLE.DF <- data.frame(#
                        SITE,#
                        LONGITUDE,#
                        LATITUDE#
                        )#
#
# create NJ plot with counties#
COUNTIES <- map_data("county")#
COUNTIES.NJ <- subset(#
                      COUNTIES,#
                      region == "new jersey"#
                      )#
NJ.PLOT <- ggplot(#
                  data = COUNTIES.NJ,#
                  aes(#
                      x = long,#
                      y = lat,#
                      group = group#
                      )#
                  ) +#
           geom_polygon(#
                        fill = "palegreen",#
                        color = "black"#
                        ) +#
           #theme_nothing() +#
           coord_fixed(1.2)#
#
# add sampling sites to NJ plot#
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme_void() +#
               theme(#
                     legend.title = element_text(#
                                                 color = "black",#
                                                 size = 16,#
                                                 face = "bold"#
                                                 ),#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12,#
                                                face = "bold"#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  name = "Site",#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                x = -73.70,#
                                y = 39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        anchor = c(#
                                   x = -73.70,#
                                   y = 39.10#
                                   ),#
                        transform = TRUE,#
                        st.size = 3#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme_void() +#
               theme(#
                     legend.title = element_text(#
                                                 color = "black",#
                                                 size = 16,#
                                                 face = "bold"#
                                                 ),#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12,#
                                                face = "bold"#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  name = "Site",#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                x = -73.70,#
                                y = 39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        anchor = c(#
                                   x = -73.70,#
                                   y = 39.10#
                                   ),#
                        transform = TRUE,#
                        st.size = 2.5#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
SAMPLE.PLOT <- NJ.PLOT +#
               geom_point(#
                          data = SAMPLE.DF,#
                          aes(#
                              x = LONGITUDE,#
                              y = LATITUDE,#
                              group = 1763,#
                              shape = SITE#
                              ),#
                          fill = "firebrick3",#
                          size = 5#
                          ) + #
               coord_fixed(1.2) +#
               theme_void() +#
               theme(#
                     legend.title = element_text(#
                                                 color = "black",#
                                                 size = 16,#
                                                 face = "bold"#
                                                 ),#
                     legend.position = "right",#
                     legend.text = element_text(#
                                                color = "black",#
                                                size = 12,#
                                                face = "bold"#
                                                )#
                     ) +#
               scale_shape_manual(#
                                  name = "Site",#
                                  labels = c(#
                                             "Caldwell House",#
                                             "Passion Puddle",#
                                             "Princeton Meadows"#
                                             ),#
                                  values = c(#
                                             21,#
                                             22,#
                                             23#
                                             )#
                                  ) +#
               north(#
                     data = COUNTIES.NJ,#
                     symbol = 5,#
                     location = "bottomright",#
                     anchor = c(#
                                x = -73.70,#
                                y = 39.25#
                                )#
                     ) +#
               scalebar(#
                        COUNTIES.NJ,#
                        dist = 10,#
                        dist_unit = "km",#
                        anchor = c(#
                                   x = -73.70,#
                                   y = 39.10#
                                   ),#
                        transform = TRUE,#
                        st.size = 2.25#
                        ) +#
               xlim(-76,-73.5)
SAMPLE.PLOT
quit()
# required packages and scripts for analysis of data#
library(ggplot2)#
library(ggpubr)#
library(dplyr)#
library(plyr)#
library(reshape)#
library(vegan)#
library(ape)#
library(GUniFrac)#
library(gridExtra)#
library(cowplot)#
library(RColorBrewer)#
library(wesanderson)#
library(VennDiagram)#
setwd("~/Downloads/duckweed_microbiome/PM_study/")#
source("~/Downloads/duckweed_microbiome/q2_analysis_using_R.R")#
#
DISTANCES <- c(#
               "bray_curtis_distance_matrix.tsv",#
               "unweighted_unifrac_distance_matrix.tsv",#
               "weighted_unifrac_distance_matrix.tsv",#
               "generalized_unifrac_distance_matrix.tsv"#
               )#
for (DISTANCE in DISTANCES){#
   # prep PCOA data#
   PCOA.OBJECT <- q2distance_2_pcoa(#
                                    DISTANCE,#
                                    "ducitaplates1_4_5-metadata.txt"#
                                    )#
   PCOA.META <- PCOA.OBJECT$points#
   PCOA.VARIANCE <- PCOA.OBJECT$variance#
   PCOA.META$time <- as.factor(#
                               PCOA.META$time#
                               )#
   PCOA.META$type <- factor(#
                            PCOA.META$type,#
                            levels = c(#
                                       "wastewater",#
                                       "ambient_water",#
                                       "treated_tissue"#
                                       )#
                            )#
   PCOA.META$bacteria <- gsub(#
                              "wastewater",#
                              "none",#
                              PCOA.META$bacteria#
                              )#
   PCOA.META$bacteria <- factor( #
                                PCOA.META$bacteria,#
                                levels = c(#
                                           "none",#
                                           "MicrobacteriumRU1A"#
                                           )#
                                )#
#
   # plot code#
   #SHAPES <- c(#
   #            "wastewater" = 21,#
   #            "ambient_water" = 24,#
   #            "treated_tissue" = 22#
   #            )#
   #FILL <- c(#
   #          "0" = "lightblue",#
   #          "5" = "dodgerblue",#
   #          "10" = "navy"#
   #          )#
   #COLOR <- c(#
   #           "none" = "black",#
   #           "MicrobacteriumRU1A" = "gold"#
   #           )#
   PLOT <- ggplot(#
                  PCOA.META,#
                  aes(x,#
                      y,#
                      fill = plate,#
                      shape = type#
                      )#
                  )#
   NAME <- strsplit(#
                    DISTANCE,#
                    "_"#
                    )[[1]]            #
   OUTPUT <- paste0(#
                    NAME[1],#
                    "_",#
                    NAME[2],#
                    "_pcoa.tiff"#
                    )#
   PCOA <- PLOT +#
           geom_point(#
                      size = 5,#
                      stroke = 1#
                      ) +#
           #scale_shape_manual(#
           #                   name = "Type",#
           #                   labels = c(#
           #                              "Wastewater",#
           #                              "Ambient Water",#
           #                              "S. polyrhiza"#
           #                              ),#
           #                   values  = SHAPES#
           #                   ) +#
           #scale_fill_manual(#
           #                  name = "Time",#
           #                  values = FILL#
           #                  ) + #
           #scale_color_manual(#
           #                   name = "Bacteria",#
           #                   labels = c(#
           #                              "None",#
           #                              "Microbacterium sp. RU1A"#
           #                              ),#
           #                   values = COLOR#
           #                   ) +#
           theme(#
                 axis.line = element_line(#
                                          color = "black",#
                                          size = 5#
                                          ),#
                 axis.title = element_text(#
                                           size = 12,#
                                           face = "bold"#
                                           ),#
                 axis.text = element_text(#
                                          face = "bold",#
                                          color = "black",#
                                          size = 10#
                                          ),#
                 legend.key = element_blank(),#
                 legend.title = element_text(#
                                             face = "bold",#
                                             size = 10#
                                             ),#
                 legend.text = element_text(#
                                            face = "bold",#
                                            size = 8#
                                            ),#
                 panel.background = element_blank()#
           ) +#
           xlab(#
                paste("PCoA 1 (",PCOA.VARIANCE[1],"%)")#
                ) +#
           ylab(#
                paste("PCoA 2 (",PCOA.VARIANCE[2],"%)")#
                ) +#
           guides(#
                  shape = guide_legend(#
                                       order = 1,#
                                       override.aes = list(size = 3),#
                                       ),#
                  fill = guide_legend(#
                                      order = 2,#
                                      override.aes = list(#
                                                          size = 3,#
                                                          color = c(#
                                                                    "lightblue",#
                                                                    "dodgerblue",#
                                                                    "navy"#
                                                                    )#
                                                          )#
                                      ),#
                  color = guide_legend(#
                                       order = 3,#
                                       override.aes = list(#
                                                           size = 3,#
                                                           shape = 22#
                                                           )#
                                       )#
                  )#
   ggsave(#
          sprintf(#
                  "%s",#
                  OUTPUT#
                  ),#
          PCOA,#
          units = "in",#
          width = 8,#
          height = 5#
          )#
}
getwd()
meta <- read_my_table("ducitaplates1_4_5-metadata.txt")
head(meta)
# required packages and scripts for analysis of data#
library(ggplot2)#
library(ggpubr)#
library(dplyr)#
library(plyr)#
library(reshape)#
library(vegan)#
library(ape)#
library(GUniFrac)#
library(gridExtra)#
library(cowplot)#
library(RColorBrewer)#
library(wesanderson)#
library(VennDiagram)#
setwd("~/Downloads/duckweed_microbiome/PM_study/")#
source("~/Downloads/duckweed_microbiome/q2_analysis_using_R.R")#
#
DISTANCES <- c(#
               "bray_curtis_distance_matrix.tsv",#
               "unweighted_unifrac_distance_matrix.tsv",#
               "weighted_unifrac_distance_matrix.tsv",#
               "generalized_unifrac_distance_matrix.tsv"#
               )#
for (DISTANCE in DISTANCES){#
   # prep PCOA data#
   PCOA.OBJECT <- q2distance_2_pcoa(#
                                    DISTANCE,#
                                    "ducitaplates1_4_5-metadata.txt"#
                                    )#
   PCOA.META <- PCOA.OBJECT$points#
   PCOA.VARIANCE <- PCOA.OBJECT$variance#
   PCOA.META$time <- as.factor(#
                               PCOA.META$time#
                               )#
   PCOA.META$type <- factor(#
                            PCOA.META$type,#
                            levels = c(#
                                       "wastewater",#
                                       "ambient_water",#
                                       "treated_tissue"#
                                       )#
                            )#
   PCOA.META$bacteria <- gsub(#
                              "wastewater",#
                              "none",#
                              PCOA.META$bacteria#
                              )#
   PCOA.META$bacteria <- factor( #
                                PCOA.META$bacteria,#
                                levels = c(#
                                           "none",#
                                           "MicrobacteriumRU1A"#
                                           )#
                                )#
#
   # plot code#
   #SHAPES <- c(#
   #            "wastewater" = 21,#
   #            "ambient_water" = 24,#
   #            "treated_tissue" = 22#
   #            )#
   #FILL <- c(#
   #          "0" = "lightblue",#
   #          "5" = "dodgerblue",#
   #          "10" = "navy"#
   #          )#
   #COLOR <- c(#
   #           "none" = "black",#
   #           "MicrobacteriumRU1A" = "gold"#
   #           )#
   PLOT <- ggplot(#
                  PCOA.META,#
                  aes(x,#
                      y,#
                      fill = plate,#
                      shape = type#
                      )#
                  )#
   NAME <- strsplit(#
                    DISTANCE,#
                    "_"#
                    )[[1]]            #
   OUTPUT <- paste0(#
                    NAME[1],#
                    "_",#
                    NAME[2],#
                    "_pcoa.tiff"#
                    )#
   PCOA <- PLOT +#
           geom_point(#
                      size = 5,#
                      stroke = 1#
                      ) +#
           #scale_shape_manual(#
           #                   name = "Type",#
           #                   labels = c(#
           #                              "Wastewater",#
           #                              "Ambient Water",#
           #                              "S. polyrhiza"#
           #                              ),#
           #                   values  = SHAPES#
           #                   ) +#
           #scale_fill_manual(#
           #                  name = "Time",#
           #                  values = FILL#
           #                  ) + #
           #scale_color_manual(#
           #                   name = "Bacteria",#
           #                   labels = c(#
           #                              "None",#
           #                              "Microbacterium sp. RU1A"#
           #                              ),#
           #                   values = COLOR#
           #                   ) +#
           theme(#
                 axis.line = element_line(#
                                          color = "black",#
                                          size = 5#
                                          ),#
                 axis.title = element_text(#
                                           size = 12,#
                                           face = "bold"#
                                           ),#
                 axis.text = element_text(#
                                          face = "bold",#
                                          color = "black",#
                                          size = 10#
                                          ),#
                 legend.key = element_blank(),#
                 legend.title = element_text(#
                                             face = "bold",#
                                             size = 10#
                                             ),#
                 legend.text = element_text(#
                                            face = "bold",#
                                            size = 8#
                                            ),#
                 panel.background = element_blank()#
           ) +#
           xlab(#
                paste("PCoA 1 (",PCOA.VARIANCE[1],"%)")#
                ) +#
           ylab(#
                paste("PCoA 2 (",PCOA.VARIANCE[2],"%)")#
                ) +#
           guides(#
                  shape = guide_legend(#
                                       order = 1,#
                                       override.aes = list(size = 3),#
                                       ),#
                  fill = guide_legend(#
                                      order = 2,#
                                      override.aes = list(#
                                                          size = 3,#
                                                          color = c(#
                                                                    "lightblue",#
                                                                    "dodgerblue",#
                                                                    "navy"#
                                                                    )#
                                                          )#
                                      ),#
                  color = guide_legend(#
                                       order = 3,#
                                       override.aes = list(#
                                                           size = 3,#
                                                           shape = 22#
                                                           )#
                                       )#
                  )#
   ggsave(#
          sprintf(#
                  "%s",#
                  OUTPUT#
                  ),#
          PCOA,#
          units = "in",#
          width = 8,#
          height = 5#
          )#
}
head(meta)
unique(meta$type)
unique(meta$bacteria)
DISTANCES <- c(#
               #"generalized_unifrac_distance_matrix.tsv"#
               "bray_curtis_distance_matrix.tsv",#
               "unweighted_unifrac_distance_matrix.tsv",#
               "weighted_unifrac_distance_matrix.tsv",#
               )#
for (DISTANCE in DISTANCES){#
   # prep PCOA data#
   PCOA.OBJECT <- q2distance_2_pcoa(#
                                    DISTANCE,#
                                    "ducitaplates1_4_5-metadata.txt"#
                                    )#
   PCOA.META <- PCOA.OBJECT$points#
   PCOA.VARIANCE <- PCOA.OBJECT$variance#
   PCOA.META$time <- as.factor(#
                               PCOA.META$time#
                               )#
   PCOA.META$type <- factor(#
                            PCOA.META$type,#
                            levels = c(#
                                       "wastewater",#
                                       "ambient_water",#
                                       "treated_tissue"#
                                       )#
                            )#
   #PCOA.META$bacteria <- gsub(#
   #                           "wastewater",#
   #                           "none",#
   #                           PCOA.META$bacteria#
   #                           )#
   #PCOA.META$bacteria <- factor( #
   #                             PCOA.META$bacteria,#
   #                             levels = c(#
   #                                        "none",#
   #                                        "MicrobacteriumRU1A"#
   #                                        )#
   #                             )#
#
   # plot code#
   #SHAPES <- c(#
   #            "wastewater" = 21,#
   #            "ambient_water" = 24,#
   #            "treated_tissue" = 22#
   #            )#
   #FILL <- c(#
   #          "0" = "lightblue",#
   #          "5" = "dodgerblue",#
   #          "10" = "navy"#
   #          )#
   #COLOR <- c(#
   #           "none" = "black",#
   #           "MicrobacteriumRU1A" = "gold"#
   #           )#
   PLOT <- ggplot(#
                  PCOA.META,#
                  aes(x,#
                      y,#
                      fill = plate,#
                      shape = type#
                      )#
                  )#
   NAME <- strsplit(#
                    DISTANCE,#
                    "_"#
                    )[[1]]            #
   OUTPUT <- paste0(#
                    NAME[1],#
                    "_",#
                    NAME[2],#
                    "_pcoa.tiff"#
                    )#
   PCOA <- PLOT +#
           geom_point(#
                      size = 5,#
                      stroke = 1#
                      ) +#
           #scale_shape_manual(#
           #                   name = "Type",#
           #                   labels = c(#
           #                              "Wastewater",#
           #                              "Ambient Water",#
           #                              "S. polyrhiza"#
           #                              ),#
           #                   values  = SHAPES#
           #                   ) +#
           #scale_fill_manual(#
           #                  name = "Time",#
           #                  values = FILL#
           #                  ) + #
           #scale_color_manual(#
           #                   name = "Bacteria",#
           #                   labels = c(#
           #                              "None",#
           #                              "Microbacterium sp. RU1A"#
           #                              ),#
           #                   values = COLOR#
           #                   ) +#
           theme(#
                 axis.line = element_line(#
                                          color = "black",#
                                          size = 5#
                                          ),#
                 axis.title = element_text(#
                                           size = 12,#
                                           face = "bold"#
                                           ),#
                 axis.text = element_text(#
                                          face = "bold",#
                                          color = "black",#
                                          size = 10#
                                          ),#
                 legend.key = element_blank(),#
                 legend.title = element_text(#
                                             face = "bold",#
                                             size = 10#
                                             ),#
                 legend.text = element_text(#
                                            face = "bold",#
                                            size = 8#
                                            ),#
                 panel.background = element_blank()#
           ) +#
           xlab(#
                paste("PCoA 1 (",PCOA.VARIANCE[1],"%)")#
                ) +#
           ylab(#
                paste("PCoA 2 (",PCOA.VARIANCE[2],"%)")#
                ) +#
           guides(#
                  shape = guide_legend(#
                                       order = 1,#
                                       override.aes = list(size = 3),#
                                       ),#
                  fill = guide_legend(#
                                      order = 2,#
                                      override.aes = list(#
                                                          size = 3,#
                                                          color = c(#
                                                                    "lightblue",#
                                                                    "dodgerblue",#
                                                                    "navy"#
                                                                    )#
                                                          )#
                                      ),#
                  color = guide_legend(#
                                       order = 3,#
                                       override.aes = list(#
                                                           size = 3,#
                                                           shape = 22#
                                                           )#
                                       )#
                  )#
   ggsave(#
          sprintf(#
                  "%s",#
                  OUTPUT#
                  ),#
          PCOA,#
          units = "in",#
          width = 8,#
          height = 5#
          )#
}
DISTANCES <- c(#
               #"generalized_unifrac_distance_matrix.tsv",#
               "bray_curtis_distance_matrix.tsv",#
               "unweighted_unifrac_distance_matrix.tsv",#
               "weighted_unifrac_distance_matrix.tsv"#
               )#
for (DISTANCE in DISTANCES){#
   # prep PCOA data#
   PCOA.OBJECT <- q2distance_2_pcoa(#
                                    DISTANCE,#
                                    "ducitaplates1_4_5-metadata.txt"#
                                    )#
   PCOA.META <- PCOA.OBJECT$points#
   PCOA.VARIANCE <- PCOA.OBJECT$variance#
   PCOA.META$time <- as.factor(#
                               PCOA.META$time#
                               )#
   PCOA.META$type <- factor(#
                            PCOA.META$type,#
                            levels = c(#
                                       "wastewater",#
                                       "ambient_water",#
                                       "treated_tissue"#
                                       )#
                            )#
   #PCOA.META$bacteria <- gsub(#
   #                           "wastewater",#
   #                           "none",#
   #                           PCOA.META$bacteria#
   #                           )#
   #PCOA.META$bacteria <- factor( #
   #                             PCOA.META$bacteria,#
   #                             levels = c(#
   #                                        "none",#
   #                                        "MicrobacteriumRU1A"#
   #                                        )#
   #                             )#
#
   # plot code#
   #SHAPES <- c(#
   #            "wastewater" = 21,#
   #            "ambient_water" = 24,#
   #            "treated_tissue" = 22#
   #            )#
   #FILL <- c(#
   #          "0" = "lightblue",#
   #          "5" = "dodgerblue",#
   #          "10" = "navy"#
   #          )#
   #COLOR <- c(#
   #           "none" = "black",#
   #           "MicrobacteriumRU1A" = "gold"#
   #           )#
   PLOT <- ggplot(#
                  PCOA.META,#
                  aes(x,#
                      y,#
                      fill = plate,#
                      shape = type#
                      )#
                  )#
   NAME <- strsplit(#
                    DISTANCE,#
                    "_"#
                    )[[1]]            #
   OUTPUT <- paste0(#
                    NAME[1],#
                    "_",#
                    NAME[2],#
                    "_pcoa.tiff"#
                    )#
   PCOA <- PLOT +#
           geom_point(#
                      size = 5,#
                      stroke = 1#
                      ) +#
           #scale_shape_manual(#
           #                   name = "Type",#
           #                   labels = c(#
           #                              "Wastewater",#
           #                              "Ambient Water",#
           #                              "S. polyrhiza"#
           #                              ),#
           #                   values  = SHAPES#
           #                   ) +#
           #scale_fill_manual(#
           #                  name = "Time",#
           #                  values = FILL#
           #                  ) + #
           #scale_color_manual(#
           #                   name = "Bacteria",#
           #                   labels = c(#
           #                              "None",#
           #                              "Microbacterium sp. RU1A"#
           #                              ),#
           #                   values = COLOR#
           #                   ) +#
           theme(#
                 axis.line = element_line(#
                                          color = "black",#
                                          size = 5#
                                          ),#
                 axis.title = element_text(#
                                           size = 12,#
                                           face = "bold"#
                                           ),#
                 axis.text = element_text(#
                                          face = "bold",#
                                          color = "black",#
                                          size = 10#
                                          ),#
                 legend.key = element_blank(),#
                 legend.title = element_text(#
                                             face = "bold",#
                                             size = 10#
                                             ),#
                 legend.text = element_text(#
                                            face = "bold",#
                                            size = 8#
                                            ),#
                 panel.background = element_blank()#
           ) +#
           xlab(#
                paste("PCoA 1 (",PCOA.VARIANCE[1],"%)")#
                ) +#
           ylab(#
                paste("PCoA 2 (",PCOA.VARIANCE[2],"%)")#
                ) +#
           guides(#
                  shape = guide_legend(#
                                       order = 1,#
                                       override.aes = list(size = 3),#
                                       ),#
                  fill = guide_legend(#
                                      order = 2,#
                                      override.aes = list(#
                                                          size = 3,#
                                                          color = c(#
                                                                    "lightblue",#
                                                                    "dodgerblue",#
                                                                    "navy"#
                                                                    )#
                                                          )#
                                      ),#
                  color = guide_legend(#
                                       order = 3,#
                                       override.aes = list(#
                                                           size = 3,#
                                                           shape = 22#
                                                           )#
                                       )#
                  )#
   ggsave(#
          sprintf(#
                  "%s",#
                  OUTPUT#
                  ),#
          PCOA,#
          units = "in",#
          width = 8,#
          height = 5#
          )#
}
DISTANCES <- c(#
               #"generalized_unifrac_distance_matrix.tsv",#
               "bray_curtis_distance_matrix.tsv",#
               "unweighted_unifrac_distance_matrix.tsv",#
               "weighted_unifrac_distance_matrix.tsv"#
               )#
for (DISTANCE in DISTANCES){#
   # prep PCOA data#
   PCOA.OBJECT <- q2distance_2_pcoa(#
                                    DISTANCE,#
                                    "ducitaplates1_4_5-metadata.txt"#
                                    )#
   PCOA.META <- PCOA.OBJECT$points#
   PCOA.VARIANCE <- PCOA.OBJECT$variance#
   PCOA.META$time <- as.factor(#
                               PCOA.META$time#
                               )#
   PCOA.META$type <- factor(#
                            PCOA.META$type,#
                            levels = c(#
                                       "wastewater",#
                                       "ambient_water",#
                                       "treated_tissue"#
                                       )#
                            )#
   #PCOA.META$bacteria <- gsub(#
   #                           "wastewater",#
   #                           "none",#
   #                           PCOA.META$bacteria#
   #                           )#
   #PCOA.META$bacteria <- factor( #
   #                             PCOA.META$bacteria,#
   #                             levels = c(#
   #                                        "none",#
   #                                        "MicrobacteriumRU1A"#
   #                                        )#
   #                             )#
#
   # plot code#
   #SHAPES <- c(#
   #            "wastewater" = 21,#
   #            "ambient_water" = 24,#
   #            "treated_tissue" = 22#
   #            )#
   #FILL <- c(#
   #          "0" = "lightblue",#
   #          "5" = "dodgerblue",#
   #          "10" = "navy"#
   #          )#
   #COLOR <- c(#
   #           "none" = "black",#
   #           "MicrobacteriumRU1A" = "gold"#
   #           )#
   PLOT <- ggplot(#
                  PCOA.META,#
                  aes(x,#
                      y,#
                      fill = plate,#
                      shape = type#
                      )#
                  )#
   NAME <- strsplit(#
                    DISTANCE,#
                    "_"#
                    )[[1]]            #
   OUTPUT <- paste0(#
                    NAME[1],#
                    "_",#
                    NAME[2],#
                    "_pcoa.tiff"#
                    )#
   PCOA <- PLOT +#
           geom_point(#
                      size = 5,#
                      stroke = 1#
                      ) +#
           #scale_shape_manual(#
           #                   name = "Type",#
           #                   labels = c(#
           #                              "Wastewater",#
           #                              "Ambient Water",#
           #                              "S. polyrhiza"#
           #                              ),#
           #                   values  = SHAPES#
           #                   ) +#
           #scale_fill_manual(#
           #                  name = "Time",#
           #                  values = FILL#
           #                  ) + #
           #scale_color_manual(#
           #                   name = "Bacteria",#
           #                   labels = c(#
           #                              "None",#
           #                              "Microbacterium sp. RU1A"#
           #                              ),#
           #                   values = COLOR#
           #                   ) +#
           theme(#
                 axis.line = element_line(#
                                          color = "black",#
                                          size = 5#
                                          ),#
                 axis.title = element_text(#
                                           size = 12,#
                                           face = "bold"#
                                           ),#
                 axis.text = element_text(#
                                          face = "bold",#
                                          color = "black",#
                                          size = 10#
                                          ),#
                 legend.key = element_blank(),#
                 legend.title = element_text(#
                                             face = "bold",#
                                             size = 10#
                                             ),#
                 legend.text = element_text(#
                                            face = "bold",#
                                            size = 8#
                                            ),#
                 panel.background = element_blank()#
           ) +#
           xlab(#
                paste("PCoA 1 (",PCOA.VARIANCE[1],"%)")#
                ) +#
           ylab(#
                paste("PCoA 2 (",PCOA.VARIANCE[2],"%)")#
                ) #
           #guides(#
           #       shape = guide_legend(#
           #                            order = 1,#
           #                            override.aes = list(size = 3),#
           #                            ),#
           #       fill = guide_legend(#
           #                           order = 2,#
           #                           override.aes = list(#
           #                                               size = 3,#
           #                                               color = c(#
           #                                                         "lightblue",#
           #                                                         "dodgerblue",#
           #                                                         "navy"#
           #                                                         )#
           #                                               )#
           #                           ),#
           #       color = guide_legend(#
           #                            order = 3,#
           #                            override.aes = list(#
           #                                                size = 3,#
           #                                                shape = 22#
           #                                                )#
           #                            )#
           #       )#
   ggsave(#
          sprintf(#
                  "%s",#
                  OUTPUT#
                  ),#
          PCOA,#
          units = "in",#
          width = 8,#
          height = 5#
          )#
}
# required packages and scripts for analysis of data#
library(ggplot2)#
library(ggpubr)#
library(dplyr)#
library(plyr)#
library(reshape)#
library(vegan)#
library(ape)#
library(GUniFrac)#
library(gridExtra)#
library(cowplot)#
library(RColorBrewer)#
library(wesanderson)#
library(VennDiagram)#
setwd("~/Downloads/duckweed_microbiome/PM_study/")#
source("~/Downloads/duckweed_microbiome/q2_analysis_using_R.R")#
#
DISTANCES <- c(#
               #"generalized_unifrac_distance_matrix.tsv",#
               "bray_curtis_distance_matrix.tsv",#
               "unweighted_unifrac_distance_matrix.tsv",#
               "weighted_unifrac_distance_matrix.tsv"#
               )#
for (DISTANCE in DISTANCES){#
   # prep PCOA data#
   PCOA.OBJECT <- q2distance_2_pcoa(#
                                    DISTANCE,#
                                    "ducitaplates1_4_5-metadata.txt"#
                                    )#
   PCOA.META <- PCOA.OBJECT$points#
   PCOA.VARIANCE <- PCOA.OBJECT$variance#
   PCOA.META$time <- as.factor(#
                               PCOA.META$time#
                               )#
   PCOA.META$type <- factor(#
                            PCOA.META$type,#
                            levels = c(#
                                       "wastewater",#
                                       "ambient_water",#
                                       "treated_tissue"#
                                       )#
                            )#
   #PCOA.META$bacteria <- gsub(#
   #                           "wastewater",#
   #                           "none",#
   #                           PCOA.META$bacteria#
   #                           )#
   #PCOA.META$bacteria <- factor( #
   #                             PCOA.META$bacteria,#
   #                             levels = c(#
   #                                        "none",#
   #                                        "MicrobacteriumRU1A"#
   #                                        )#
   #                             )#
#
   # plot code#
   #SHAPES <- c(#
   #            "wastewater" = 21,#
   #            "ambient_water" = 24,#
   #            "treated_tissue" = 22#
   #            )#
   #FILL <- c(#
   #          "0" = "lightblue",#
   #          "5" = "dodgerblue",#
   #          "10" = "navy"#
   #          )#
   #COLOR <- c(#
   #           "none" = "black",#
   #           "MicrobacteriumRU1A" = "gold"#
   #           )#
   PLOT <- ggplot(#
                  PCOA.META,#
                  aes(x,#
                      y,#
                      fill = plate,#
                      shape = type#
                      )#
                  )#
   NAME <- strsplit(#
                    DISTANCE,#
                    "_"#
                    )[[1]]            #
   OUTPUT <- paste0(#
                    NAME[1],#
                    "_",#
                    NAME[2],#
                    "_pcoa.tiff"#
                    )#
   PCOA <- PLOT +#
           geom_point(#
                      size = 5,#
                      stroke = 1#
                      ) +#
           theme(#
                 axis.line = element_line(#
                                          color = "black",#
                                          size = 5#
                                          ),#
                 axis.title = element_text(#
                                           size = 12,#
                                           face = "bold"#
                                           ),#
                 axis.text = element_text(#
                                          face = "bold",#
                                          color = "black",#
                                          size = 10#
                                          ),#
                 legend.key = element_blank(),#
                 legend.title = element_text(#
                                             face = "bold",#
                                             size = 10#
                                             ),#
                 legend.text = element_text(#
                                            face = "bold",#
                                            size = 8#
                                            ),#
                 panel.background = element_blank()#
           ) +#
           xlab(#
                paste("PCoA 1 (",PCOA.VARIANCE[1],"%)")#
                ) +#
           ylab(#
                paste("PCoA 2 (",PCOA.VARIANCE[2],"%)")#
                ) #
   ggsave(#
          sprintf(#
                  "%s",#
                  OUTPUT#
                  ),#
          PCOA,#
          units = "in",#
          width = 8,#
          height = 5#
          )#
}#
           #scale_shape_manual(#
           #                   name = "Type",#
           #                   labels = c(#
           #                              "Wastewater",#
           #                              "Ambient Water",#
           #                              "S. polyrhiza"#
           #                              ),#
           #                   values  = SHAPES#
           #                   ) +#
           #scale_fill_manual(#
           #                  name = "Time",#
           #                  values = FILL#
           #                  ) + #
           #scale_color_manual(#
           #                   name = "Bacteria",#
           #                   labels = c(#
           #                              "None",#
           #                              "Microbacterium sp. RU1A"#
           #                              ),#
           #                   values = COLOR#
           #                   ) +#
           #guides(#
           #       shape = guide_legend(#
           #                            order = 1,#
           #                            override.aes = list(size = 3),#
           #                            ),#
           #       fill = guide_legend(#
           #                           order = 2,#
           #                           override.aes = list(#
           #                                               size = 3,#
           #                                               color = c(#
           #                                                         "lightblue",#
           #                                                         "dodgerblue",#
           #                                                         "navy"#
           #                                                         )#
           #                                               )#
           #                           ),#
           #       color = guide_legend(#
           #                            order = 3,#
           #                            override.aes = list(#
           #                                                size = 3,#
           #                                                shape = 22#
           #                                                )#
           #                            )#
           #       )
DISTANCES <- c(#
               #"generalized_unifrac_distance_matrix.tsv",#
               "bray_curtis_distance_matrix.tsv",#
               "unweighted_unifrac_distance_matrix.tsv",#
               "weighted_unifrac_distance_matrix.tsv"#
               )#
for (DISTANCE in DISTANCES){#
   # prep PCOA data#
   PCOA.OBJECT <- q2distance_2_pcoa(#
                                    DISTANCE,#
                                    "ducitaplates1_4_5-metadata.txt"#
                                    )#
   PCOA.META <- PCOA.OBJECT$points#
   PCOA.VARIANCE <- PCOA.OBJECT$variance#
   PCOA.META$time <- as.factor(#
                               PCOA.META$time#
                               )#
   PCOA.META$type <- factor(#
                            PCOA.META$type,#
                            levels = c(#
                                       "wastewater",#
                                       "ambient_water",#
                                       "treated_tissue"#
                                       )#
                            )#
   PLOT <- ggplot(#
                  PCOA.META,#
                  aes(x,#
                      y,#
                      fill = plate,#
                      shape = type#
                      )#
                  )#
   NAME <- strsplit(#
                    DISTANCE,#
                    "_"#
                    )[[1]]            #
   OUTPUT <- paste0(#
                    NAME[1],#
                    "_",#
                    NAME[2],#
                    "_pcoa.tiff"#
                    )#
   PCOA <- PLOT +#
           geom_point(#
                      size = 5,#
                      stroke = 1#
                      ) +#
           theme(#
                 axis.line = element_line(#
                                          color = "black",#
                                          size = 5#
                                          ),#
                 axis.title = element_text(#
                                           size = 12,#
                                           face = "bold"#
                                           ),#
                 axis.text = element_text(#
                                          face = "bold",#
                                          color = "black",#
                                          size = 10#
                                          ),#
                 legend.key = element_blank(),#
                 legend.title = element_text(#
                                             face = "bold",#
                                             size = 10#
                                             ),#
                 legend.text = element_text(#
                                            face = "bold",#
                                            size = 8#
                                            ),#
                 panel.background = element_blank()#
           ) +#
           xlab(#
                paste("PCoA 1 (",PCOA.VARIANCE[1],"%)")#
                ) +#
           ylab(#
                paste("PCoA 2 (",PCOA.VARIANCE[2],"%)")#
                ) #
   ggsave(#
          sprintf(#
                  "%s",#
                  OUTPUT#
                  ),#
          PCOA,#
          units = "in",#
          width = 8,#
          height = 5#
          )#
}
DISTANCES <- c(#
               #"generalized_unifrac_distance_matrix.tsv",#
               "bray_curtis_distance_matrix.tsv",#
               "unweighted_unifrac_distance_matrix.tsv",#
               "weighted_unifrac_distance_matrix.tsv"#
               )#
for (DISTANCE in DISTANCES){#
   # prep PCOA data#
   PCOA.OBJECT <- q2distance_2_pcoa(#
                                    DISTANCE,#
                                    "ducitaplates1_4_5-metadata.txt"#
                                    )#
   PCOA.META <- PCOA.OBJECT$points#
   PCOA.VARIANCE <- PCOA.OBJECT$variance#
   print(str(PCOA.META))#
   PCOA.META$time <- as.factor(#
                               PCOA.META$time#
                               )#
   PCOA.META$type <- factor(#
                            PCOA.META$type,#
                            levels = c(#
                                       "wastewater",#
                                       "ambient_water",#
                                       "treated_tissue"#
                                       )#
                            )#
   PLOT <- ggplot(#
                  PCOA.META,#
                  aes(x,#
                      y,#
                      fill = plate,#
                      shape = type#
                      )#
                  )#
   NAME <- strsplit(#
                    DISTANCE,#
                    "_"#
                    )[[1]]            #
   OUTPUT <- paste0(#
                    NAME[1],#
                    "_",#
                    NAME[2],#
                    "_pcoa.tiff"#
                    )#
   PCOA <- PLOT +#
           geom_point(#
                      size = 5,#
                      stroke = 1#
                      ) +#
           theme(#
                 axis.line = element_line(#
                                          color = "black",#
                                          size = 5#
                                          ),#
                 axis.title = element_text(#
                                           size = 12,#
                                           face = "bold"#
                                           ),#
                 axis.text = element_text(#
                                          face = "bold",#
                                          color = "black",#
                                          size = 10#
                                          ),#
                 legend.key = element_blank(),#
                 legend.title = element_text(#
                                             face = "bold",#
                                             size = 10#
                                             ),#
                 legend.text = element_text(#
                                            face = "bold",#
                                            size = 8#
                                            ),#
                 panel.background = element_blank()#
           ) +#
           xlab(#
                paste("PCoA 1 (",PCOA.VARIANCE[1],"%)")#
                ) +#
           ylab(#
                paste("PCoA 2 (",PCOA.VARIANCE[2],"%)")#
                ) #
   ggsave(#
          sprintf(#
                  "%s",#
                  OUTPUT#
                  ),#
          PCOA,#
          units = "in",#
          width = 8,#
          height = 5#
          )#
}#
   #PCOA.META$bacteria <- gsub(#
   #                           "wastewater",#
   #                           "none",#
   #                           PCOA.META$bacteria#
   #                           )#
   #PCOA.META$bacteria <- factor( #
   #                             PCOA.META$bacteria,#
   #                             levels = c(#
   #                                        "none",#
   #                                        "MicrobacteriumRU1A"#
   #                                        )#
   #                             )#
#
   # plot code#
   #SHAPES <- c(#
   #            "wastewater" = 21,#
   #            "ambient_water" = 24,#
   #            "treated_tissue" = 22#
   #            )#
   #FILL <- c(#
   #          "0" = "lightblue",#
   #          "5" = "dodgerblue",#
   #          "10" = "navy"#
   #          )#
   #COLOR <- c(#
   #           "none" = "black",#
   #           "MicrobacteriumRU1A" = "gold"#
   #           )#
           #scale_shape_manual(#
           #                   name = "Type",#
           #                   labels = c(#
           #                              "Wastewater",#
           #                              "Ambient Water",#
           #                              "S. polyrhiza"#
           #                              ),#
           #                   values  = SHAPES#
           #                   ) +#
           #scale_fill_manual(#
           #                  name = "Time",#
           #                  values = FILL#
           #                  ) + #
           #scale_color_manual(#
           #                   name = "Bacteria",#
           #                   labels = c(#
           #                              "None",#
           #                              "Microbacterium sp. RU1A"#
           #                              ),#
           #                   values = COLOR#
           #                   ) +#
           #guides(#
           #       shape = guide_legend(#
           #                            order = 1,#
           #                            override.aes = list(size = 3),#
           #                            ),#
           #       fill = guide_legend(#
           #                           order = 2,#
           #                           override.aes = list(#
           #                                               size = 3,#
           #                                               color = c(#
           #                                                         "lightblue",#
           #                                                         "dodgerblue",#
           #                                                         "navy"#
           #                                                         )#
           #                                               )#
           #                           ),#
           #       color = guide_legend(#
           #                            order = 3,#
           #                            override.aes = list(#
           #                                                size = 3,#
           #                                                shape = 22#
           #                                                )#
           #                            )#
           #       )
DISTANCES <- c(#
               #"generalized_unifrac_distance_matrix.tsv",#
               "bray_curtis_distance_matrix.tsv",#
               "unweighted_unifrac_distance_matrix.tsv",#
               "weighted_unifrac_distance_matrix.tsv"#
               )#
for (DISTANCE in DISTANCES){#
   # prep PCOA data#
   PCOA.OBJECT <- q2distance_2_pcoa(#
                                    DISTANCE,#
                                    "ducitaplates1_4_5-metadata.txt"#
                                    )#
   PCOA.META <- PCOA.OBJECT$points#
   PCOA.VARIANCE <- PCOA.OBJECT$variance#
   print(str(PCOA.META))#
   PCOA.META$time <- as.factor(#
                               PCOA.META$time#
                               )#
   PCOA.META$type <- factor(#
                            PCOA.META$type,#
                            levels = c(#
                                       "wastewater",#
                                       "ambient_water",#
                                       "treated_tissue"#
                                       )#
                            )#
   PLOT <- ggplot(#
                  PCOA.META,#
                  aes(x,#
                      y,#
                      color = plate,#
                      shape = type#
                      )#
                  )#
   NAME <- strsplit(#
                    DISTANCE,#
                    "_"#
                    )[[1]]            #
   OUTPUT <- paste0(#
                    NAME[1],#
                    "_",#
                    NAME[2],#
                    "_pcoa.tiff"#
                    )#
   PCOA <- PLOT +#
           geom_point(#
                      size = 5,#
                      stroke = 1#
                      ) +#
           theme(#
                 axis.line = element_line(#
                                          color = "black",#
                                          size = 5#
                                          ),#
                 axis.title = element_text(#
                                           size = 12,#
                                           face = "bold"#
                                           ),#
                 axis.text = element_text(#
                                          face = "bold",#
                                          color = "black",#
                                          size = 10#
                                          ),#
                 legend.key = element_blank(),#
                 legend.title = element_text(#
                                             face = "bold",#
                                             size = 10#
                                             ),#
                 legend.text = element_text(#
                                            face = "bold",#
                                            size = 8#
                                            ),#
                 panel.background = element_blank()#
           ) +#
           xlab(#
                paste("PCoA 1 (",PCOA.VARIANCE[1],"%)")#
                ) +#
           ylab(#
                paste("PCoA 2 (",PCOA.VARIANCE[2],"%)")#
                ) #
   ggsave(#
          sprintf(#
                  "%s",#
                  OUTPUT#
                  ),#
          PCOA,#
          units = "in",#
          width = 8,#
          height = 5#
          )#
}
for (DISTANCE in DISTANCES){#
   # prep PCOA data#
   PCOA.OBJECT <- q2distance_2_pcoa(#
                                    DISTANCE,#
                                    "ducitaplates1_4_5-metadata.txt"#
                                    )#
   PCOA.META <- PCOA.OBJECT$points#
   PCOA.VARIANCE <- PCOA.OBJECT$variance#
   print(str(PCOA.META))#
   PCOA.META$time <- as.factor(#
                               PCOA.META$time#
                               )#
   PCOA.META$type <- factor(#
                            PCOA.META$type,#
                            levels = c(#
                                       "wastewater",#
                                       "ambient_water",#
                                       "treated_tissue"#
                                       )#
                            )#
   SHAPES <- c(#
               "wastewater" = 21,#
               "ambient_water" = 24,#
               "treated_tissue" = 22#
               )#
   PLOT <- ggplot(#
                  PCOA.META,#
                  aes(x,#
                      y,#
                      fill = plate,#
                      shape = type,#
                      color = time#
                      )#
                  )#
   NAME <- strsplit(#
                    DISTANCE,#
                    "_"#
                    )[[1]]            #
   OUTPUT <- paste0(#
                    NAME[1],#
                    "_",#
                    NAME[2],#
                    "_pcoa.tiff"#
                    )#
   PCOA <- PLOT +#
           geom_point(#
                      size = 5,#
                      stroke = 1#
                      ) +#
           scale_shape_manual(#
                              name = "Type",#
                              labels = c(#
                                         "Wastewater",#
                                         "Ambient Water",#
                                         "Duckweed"#
                                         ),#
                              values  = SHAPES#
                              ) +#
           theme(#
                 axis.line = element_line(#
                                          color = "black",#
                                          size = 5#
                                          ),#
                 axis.title = element_text(#
                                           size = 12,#
                                           face = "bold"#
                                           ),#
                 axis.text = element_text(#
                                          face = "bold",#
                                          color = "black",#
                                          size = 10#
                                          ),#
                 legend.key = element_blank(),#
                 legend.title = element_text(#
                                             face = "bold",#
                                             size = 10#
                                             ),#
                 legend.text = element_text(#
                                            face = "bold",#
                                            size = 8#
                                            ),#
                 panel.background = element_blank()#
           ) +#
           xlab(#
                paste("PCoA 1 (",PCOA.VARIANCE[1],"%)")#
                ) +#
           ylab(#
                paste("PCoA 2 (",PCOA.VARIANCE[2],"%)")#
                ) #
   ggsave(#
          sprintf(#
                  "%s",#
                  OUTPUT#
                  ),#
          PCOA,#
          units = "in",#
          width = 8,#
          height = 5#
          )#
}#
   #PCOA.META$bacteria <- gsub(#
   #                           "wastewater",#
   #                           "none",#
   #                           PCOA.META$bacteria#
   #                           )#
   #PCOA.META$bacteria <- factor( #
   #                             PCOA.META$bacteria,#
   #                             levels = c(#
   #                                        "none",#
   #                                        "MicrobacteriumRU1A"#
   #                                        )#
   #                             )#
#
   # plot code#
   #FILL <- c(#
   #          "0" = "lightblue",#
   #          "5" = "dodgerblue",#
   #          "10" = "navy"#
   #          )#
   #COLOR <- c(#
   #           "none" = "black",#
   #           "MicrobacteriumRU1A" = "gold"#
   #           )#
           #scale_fill_manual(#
           #                  name = "Time",#
           #                  values = FILL#
           #                  ) + #
           #scale_color_manual(#
           #                   name = "Bacteria",#
           #                   labels = c(#
           #                              "None",#
           #                              "Microbacterium sp. RU1A"#
           #                              ),#
           #                   values = COLOR#
           #                   ) +#
           #guides(#
           #       shape = guide_legend(#
           #                            order = 1,#
           #                            override.aes = list(size = 3),#
           #                            ),#
           #       fill = guide_legend(#
           #                           order = 2,#
           #                           override.aes = list(#
           #                                               size = 3,#
           #                                               color = c(#
           #                                                         "lightblue",#
           #                                                         "dodgerblue",#
           #                                                         "navy"#
           #                                                         )#
           #                                               )#
           #                           ),#
           #       color = guide_legend(#
           #                            order = 3,#
           #                            override.aes = list(#
           #                                                size = 3,#
           #                                                shape = 22#
           #                                                )#
           #                            )#
           #       )
DISTANCE <- read.table("bray_curtis_distance_matrix.tsv",#
                          sep="\t",#
                          header=1,#
                          row.names=1)#
   MATRIX <- as.matrix(DISTANCE)#
   MDS <- cmdscale(MATRIX,#
                   eig=TRUE,#
                   x.ret=TRUE)
MDS
CAP <- capsclae(DISTANCE~type+time+tissue)
CAP <- capscale(DISTANCE~type+time+tissue)
CAP <- capscale(DISTANCE~type+time+tissue,data=meta)
nrow(meta)
nrow(DISTANCE)
str(meta)
meta <- filter(meta,sample_id %in% colnames(DISTANCE))
meta <- filter(meta,sample-id %in% colnames(DISTANCE))
colnames(DISTANCE)
DISTANCE <- read.table("bray_curtis_distance_matrix.tsv",#
                          sep="\t",#
                          header=1,#
                          row.names=1,check.names=F)#
   MATRIX <- as.matrix(DISTANCE)#
   MDS <- cmdscale(MATRIX,#
                   eig=TRUE,#
                   x.ret=TRUE)
colnames(DISTANCE)
meta <- filter(meta,sample-id %in% colnames(DISTANCE))
meta$sample_id
meta$sample0id
meta$sample-id
meta
str(meta)
meta$sample-id
colnames(meta)[1] <- "sample_id"
meta <- filter(meta,sample_id %in% colnames(DISTANCE))
nrow(meta)
CAP <- capscale(DISTANCE~type+time+tissue,data=meta)
head(CAP)
str(CAP)
str(MDS)
quit()
